!function(){"use strict";function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,i){if(!t)return;if("string"==typeof t)return e(t,i);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,i)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}var n=function(){function e(){}return e.extend=function(){for(var t=1;t<arguments.length;t++)for(var e in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],e)&&("object"===i(arguments[0][e])&&"object"===i(arguments[t][e])?this.extend(arguments[0][e],arguments[t][e]):arguments[0][e]=arguments[t][e]);return arguments[0]},e.htmlDecode=function(t){return(new DOMParser).parseFromString(t,"text/html").documentElement.textContent},e.stripHTML=function(t){var e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""},e.closestParent=function(t,e){if("object"!==i(t)||"string"!=typeof e)return null;if(!t.parentNode)return null;if("."===e.substr(0,1)){if(e.split(".").filter((function(t){return""!==t})).every((function(e){var i,n;return null===(i=t.parentNode)||void 0===i||null===(n=i.classList)||void 0===n?void 0:n.contains(e)})))return t.parentNode}else if("#"===e.substr(0,1)){if("function"==typeof t.parentNode.getAttribute&&t.parentNode.getAttribute("id")===e.substr(1))return t.parentNode}else if(t.parentNode.tagName.toLowerCase()===e.toLowerCase())return t.parentNode;return this.closestParent(t.parentNode,e)},e.shuffleArray=function(e){var i,n,s,a=t(e);for(s=a.length-1;s>0;s--)i=Math.floor(Math.random()*(s+1)),n=a[s],a[s]=a[i],a[i]=n;return a},e}(),s=n,a=function(){function t(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.params=e,this.callbacks=s.extend({onPuzzleTileCreated:function(){},onPuzzleTileMoveStarted:function(){},onPuzzleTileMoved:function(){},onPuzzleTileMoveEnded:function(){}},i),this.pathBorders={},this.moveInitialX=null,this.moveInitialY=null,this.deltaX=null,this.deltaY=null,this.isDone=!1,this.scale=1,this.backgroundImage=new Image,this.backgroundImage.addEventListener("load",(function(){t.handleImageLoaded()})),this.backgroundImage.crossOrigin=e.imageCrossOrigin,this.backgroundImage.src=e.imageSource,this.handleTileMoveStarted=this.handleTileMoveStarted.bind(this),this.handleTileMoved=this.handleTileMoved.bind(this),this.handleTileMoveEnded=this.handleTileMoveEnded.bind(this),this.handleAnimationMoveEnded=this.handleAnimationMoveEnded.bind(this),this.tile=document.createElement("div"),this.tile.classList.add("h5p-jigsaw-puzzle-tile"),this.setScale(this.scale)}var e=t.prototype;return e.getDOM=function(){return this.tile},e.getHTML=function(){return this.tile.outerHTML},e.buildSVG=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=document.createElement("svg");i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("viewBox","0 0 ".concat(e.width+e.stroke," ").concat(e.height+e.stroke));var n=document.createElement("defs"),s=document.createElement("pattern");s.setAttribute("id","h5p-jigsaw-puzzle-".concat(this.params.uuid,"-pattern-").concat(this.params.id)),s.setAttribute("width",this.params.size.width),s.setAttribute("height",this.params.size.height),s.setAttribute("x",-(this.params.gridPosition.x*this.params.baseWidth*this.scale-Math.sign(this.params.gridPosition.x)*this.knob/2)/this.width),s.setAttribute("y",-(this.params.gridPosition.y*this.params.baseHeight*this.scale-Math.sign(this.params.gridPosition.y)*this.knob/2)/this.height);var a=document.createElement("image");a.setAttribute("width",e.image.naturalWidth),a.setAttribute("height",e.image.naturalHeight),a.setAttribute("href",e.image.src),s.appendChild(a),n.appendChild(s),i.appendChild(n);var o=document.createElement("path");return o.setAttribute("fill","url(#h5p-jigsaw-puzzle-".concat(this.params.uuid,"-pattern-").concat(this.params.id,")")),o.setAttribute("stroke-opacity","0"),o.setAttribute("stroke-width",e.stroke),o.setAttribute("d",this.buildPathDash({width:e.baseWidth,height:e.baseHeight,type:e.type,stroke:e.stroke})),i.appendChild(o),["top","right","bottom","left"].forEach((function(n){t.pathBorders[n]=t.buildPathDOM({stroke:e.stroke,color:t.params.borderColor,width:e.baseWidth,height:e.baseHeight,orientation:t.params.borders[n].orientation,opacity:t.params.borders[n].opacity,side:n,gridPosition:{x:t.params.gridPosition.x,y:t.params.gridPosition.y},className:"border-".concat(n)}),i.appendChild(t.pathBorders[n])})),i},e.buildPathDOM=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=document.createElement("path");return t.className&&e.classList.add(t.className),e.setAttribute("fill-opacity","0"),e.setAttribute("stroke",t.color),e.setAttribute("stroke-width",t.stroke),e.setAttribute("stroke-opacity",t.opacity),e.setAttribute("d",this.buildPathSegment({width:t.width,height:t.height,orientation:t.orientation,stroke:t.stroke,side:t.side,gridPosition:{x:this.params.gridPosition.x,y:this.params.gridPosition.y}})),e},e.buildPathSegment=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=Math.min(e.width,e.height)/2,n="right"===e.side?e.width:0;0!==e.gridPosition.x&&(n+=e.stroke/2+i/2);var s="bottom"===e.side?e.height:0;0!==e.gridPosition.y&&(s+=e.stroke/2+i/2);var a="M ".concat(n,", ").concat(s),o="top"===e.side||"bottom"===e.side?"horizontal":"vertical",r=t.PATHS_BORDER["".concat(o,"-").concat(e.orientation)];return"".concat(a," ").concat(r).replace(/@w/g,e.width).replace(/@h/g,e.height).replace(/@knob/g,i).replace(/@gapw/g,(e.width-i)/2).replace(/@gaph/g,(e.height-i)/2)},e.buildPathDash=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=Math.min(e.width,e.height)/2;return t.PATHS[e.type].replace(/@offknob/g,e.stroke/2+i/2).replace(/@off/g,e.stroke/2).replace(/@w/g,e.width).replace(/@h/g,e.height).replace(/@knob/g,i).replace(/@gapw/g,(e.width-i)/2).replace(/@gaph/g,(e.height-i)/2)},e.updateParams=function(t){this.params=s.extend(this.params,t),this.repaintSVG()},e.setZIndex=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";""!==t&&"number"!=typeof t||(this.tile.style.zIndex=t)},e.getGridPosition=function(){return{x:this.params.gridPosition.x,y:this.params.gridPosition.y}},e.getId=function(){return this.params.id},e.setScale=function(t){"number"!=typeof t||t<0||(this.scale=t,this.width=this.scale*this.params.width,this.height=this.scale*this.params.height,this.knob=this.scale*this.params.knobSize,this.stroke=this.scale*this.params.stroke,this.tile.style.width="".concat(this.width+this.stroke,"px"),this.tile.style.height="".concat(this.height+this.stroke,"px"))},e.getSize=function(){return this.tile.style.width&&this.tile.style.height?{baseWidth:this.params.baseWidth,baseHeight:this.params.baseHeight,width:this.width,height:this.height,knob:this.knob,stroke:this.stroke}:null},e.getPosition=function(){return this.tile.style.left&&this.tile.style.top?{x:parseFloat(this.tile.style.left),y:parseFloat(this.tile.style.top)}:null},e.setPosition=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("number"==typeof t.x&&"number"==typeof t.y){var e=this.params.container,i=e.offsetLeft,n=e.offsetLeft+e.offsetWidth-this.width,s=e.offsetTop,a=e.offsetTop+e.offsetHeight-this.height;this.tile.style.left="".concat(Math.min(Math.max(i,t.x),n),"px"),this.tile.style.top="".concat(Math.min(Math.max(s,t.y),a),"px")}},e.setBorders=function(t){for(var e in t){if("boolean"!=typeof t[e])return;var i=this.tile.querySelector(".border-".concat(e));i&&i.setAttribute("stroke-opacity",t[e]?"1":"0")}},e.setDone=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isDone=t},e.show=function(){this.tile.classList.remove("hidden")},e.hide=function(){this.tile.classList.add("hidden")},e.ghost=function(){this.tile.classList.add("ghosted")},e.unghost=function(){this.tile.classList.remove("ghosted")},e.enable=function(){this.tile.removeAttribute("disabled","disabled"),this.isDisabled=!1},e.disable=function(){this.isDisabled=!0,this.tile.setAttribute("disabled","disabled")},e.putInBackground=function(){this.tile.classList.remove("onTop")},e.putOnTop=function(){this.tile.classList.add("onTop")},e.animateMove=function(){this.tile.removeEventListener("transitionend",this.handleAnimationMoveEnded),this.tile.addEventListener("transitionend",this.handleAnimationMoveEnded),this.tile.classList.add("animate-move")},e.repaintSVG=function(){var t=this.buildSVG({id:this.params.id,gridPosition:this.params.gridPosition,baseWidth:this.params.baseWidth,baseHeight:this.params.baseHeight,width:this.params.width,height:this.params.height,stroke:this.params.stroke,image:this.backgroundImage,type:this.params.type});this.tile.innerHTML=t.outerHTML},e.handleImageLoaded=function(){this.setScale(this.scale),this.repaintSVG(),this.callbacks.onPuzzleTileCreated(this),this.tile.addEventListener("touchstart",this.handleTileMoveStarted,!0),this.tile.addEventListener("mousedown",this.handleTileMoveStarted,!0)},e.handleTileMoveStarted=function(t){this.isDisabled||(this.tile.classList.remove("animate-move"),(t=t||window.event).preventDefault(),"touchstart"===t.type?(this.moveInitialX=this.tile.offsetLeft-t.touches[0].clientX,this.moveInitialY=this.tile.offsetTop-t.touches[0].clientY,this.tile.addEventListener("touchmove",this.handleTileMoved,!1),this.tile.addEventListener("touchend",this.handleTileMoveEnded,!1)):(this.moveInitialX=this.tile.offsetLeft-t.clientX,this.moveInitialY=this.tile.offsetTop-t.clientY,document.addEventListener("mousemove",this.handleTileMoved,!0),document.addEventListener("mouseup",this.handleTileMoveEnded,!0)),this.callbacks.onPuzzleTileMoveStarted(this))},e.handleTileMoved=function(t){(t=t||window.event).preventDefault(),"touchmove"===t.type?this.setPosition({x:this.moveInitialX+t.touches[0].clientX,y:this.moveInitialY+t.touches[0].clientY}):this.setPosition({x:this.moveInitialX+t.clientX,y:this.moveInitialY+t.clientY}),this.callbacks.onPuzzleTileMoved(this)},e.handleTileMoveEnded=function(){this.tile.removeEventListener("touchmove",this.handleTileMoved,!1),this.tile.removeEventListener("touchend",this.handleTileMoveEnded,!1),document.removeEventListener("mousemove",this.handleTileMoved,!0),document.removeEventListener("mouseup",this.handleTileMoveEnded,!0),this.tile.classList.add("animate-move"),this.callbacks.onPuzzleTileMoveEnded(this)},e.handleAnimationMoveEnded=function(){this.tile.style.transitionDuration="",this.tile.classList.remove("animate-move"),this.tile.removeEventListener("transitionend",this.handleAnimationMoveEnded)},t}();a.PATHS={"top-left":"M @off, @off l @w, 0 l 0, @gaph a 1 1 0 0 0 0 @knob l 0, @gaph l -@gapw, 0 a 1 1 0 0 0 -@knob 0 l -@gapw, 0 l 0 -@h Z","top-inner":"M @offknob, @off l @w, 0 l 0, @gaph a 1 1 0 0 0 0 @knob l 0, @gaph l -@gapw, 0 a 1 1 0 0 0 -@knob 0 l -@gapw, 0 l 0, -@gaph a 1 1 0 0 1 0 -@knob l 0, -@gaph Z","top-right":"M @offknob, @off l @w, 0 l 0, @h l -@gapw, 0 a 1 1 0 0 0 -@knob 0 l -@gapw, 0 l 0, -@gaph a 1 1 0 0 1 0 -@knob l 0, -@gaph Z","inner-left":"M @off, @offknob l @gapw, 0 a 1 1 0 0 1 @knob 0 l @gapw, 0 l 0, @gaph a 1 1 0 0 0 0 @knob l 0, @gaph l -@gapw, 0 a 1 1 0 0 0 -@knob 0 l -@gapw, 0 l 0, -@h Z","inner-inner":"M @offknob, @offknob l @gapw, 0 a 1 1 0 0 1 @knob 0 l @gapw, 0 l 0, @gaph a 1 1 0 0 0 0 @knob l 0, @gaph l -@gapw, 0 a 1 1 0 0 0 -@knob 0 l -@gapw, 0 l 0, -@gaph a 1 1 0 0 1 0 -@knob l 0, -@gaph Z","inner-right":"M @offknob, @offknob l @gapw, 0 a 1 1 0 0 1 @knob 0 l @gapw, 0 l 0, @h l -@gapw, 0 a 1 1 0 0 0 -@knob 0 l -@gapw, 0 l 0, -@gaph a 1 1 0 0 1 0 -@knob l 0, -@gaph Z","bottom-left":"M @off, @offknob l @gapw, 0 a 1 1 0 0 1 @knob 0 l @gapw, 0 l 0, @gaph a 1 1 0 0 0 0 @knob l 0, @gaph l -@w, 0 l 0, -@h Z","bottom-inner":"M @offknob, @offknob l @gapw, 0 a 1 1 0 0 1 @knob 0 l @gapw, 0 l 0, @gaph a 1 1 0 0 0 0 @knob l 0, @gaph l -@w, 0 l 0, -@gaph a 1 1 0 0 1 0 -@knob l 0, -@gaph Z","bottom-right":"M @offknob, @offknob l @gapw, 0 a 1 1 0 0 1 @knob 0 l @gapw, 0 l 0, @h l -@w, 0 l 0, -@gaph a 1 1 0 0 1 0 -@knob l 0, -@gaph Z"},a.PATHS_BORDER={"horizontal-straight":"l @w, 0","horizontal-up":"l @gapw, 0 a 1 1 0 0 1 @knob 0 l @gapw, 0","horizontal-down":"l @gapw, 0 a 1 1 0 0 0 @knob 0 l @gapw, 0","vertical-straight":"l 0, @h","vertical-left":"l 0, @gaph a 1 1 0 0 0 0 @knob l 0, @gaph","vertical-right":"l 0, @gaph a 1 1 0 0 1 0 @knob l 0, @gaph"};var o=function(){function t(t,e){var i=this;this.params=s.extend({a11y:{active:"",disabled:"",inactive:""},active:!1,classes:[],disabled:!1,hidden:!1,type:"pulse",noTabWhenDisabled:!1},t||{}),Array.isArray(this.params.classes)||(this.params.classes=[this.params.classes]),"pulse"===this.params.type&&(this.params.a11y.inactive||(this.params.a11y.inactive=this.params.a11y.active||""),this.params.a11y.active||(this.params.a11y.active=this.params.a11y.inactive||"")),this.active=this.params.active,this.disabled=this.params.disabled,this.visible=!this.params.hidden,this.callbacks=s.extend({onClick:function(){}},e),this.button=document.createElement("button"),this.params.classes&&this.params.classes.forEach((function(t){i.button.classList.add(t)})),this.button.setAttribute("aria-pressed",this.params.active),this.button.setAttribute("tabindex","0"),!0===this.params.active?this.activate():this.deactivate(),!0===this.params.disabled?this.disable():this.enable(),!0===this.params.hidden?this.hide():this.show(),this.button.addEventListener("click",(function(t){i.disabled||("toggle"===i.params.type&&i.toggle(),i.callbacks.onClick(t))}))}var e=t.prototype;return e.getDOM=function(){return this.button},e.show=function(){this.button.classList.remove("h5p-jigsaw-puzzle-display-none"),this.visible=!0},e.hide=function(){this.button.classList.add("h5p-jigsaw-puzzle-display-none"),this.visible=!1},e.enable=function(){this.disabled=!1,this.button.classList.remove("h5p-jigsaw-puzzle-button-disabled"),this.params.noTabWhenDisabled&&this.button.setAttribute("tabindex",0),this.active?this.activate():this.deactivate()},e.disable=function(){this.button.classList.add("h5p-jigsaw-puzzle-button-disabled"),this.button.setAttribute("aria-label",this.params.a11y.disabled),this.params.noTabWhenDisabled&&this.button.setAttribute("tabindex",-1),this.disabled=!0},e.activate=function(){this.disabled||("toggle"===this.params.type&&(this.button.classList.add("h5p-jigsaw-puzzle-button-active"),this.button.setAttribute("aria-pressed",!0)),this.button.setAttribute("aria-label",this.params.a11y.active),this.active=!0)},e.deactivate=function(){this.disabled||(this.active=!1,"toggle"===this.params.type&&(this.button.classList.remove("h5p-jigsaw-puzzle-button-active"),this.button.setAttribute("aria-pressed",!1)),this.button.setAttribute("aria-label",this.params.a11y.inactive))},e.toggle=function(t){this.disabled||((t="boolean"==typeof t?t:!this.active)?this.activate():this.deactivate())},e.isActive=function(){return this.active},e.isDisabled=function(){return this.disabled},e.isVisible=function(){},t}(),r=function(){function t(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.params=s.extend({a11y:{buttonFullscreenEnter:"Enter fullscreen mode",buttonFullscreenExit:"Exit fullscreen mode",buttonAudioMute:"Mute music",buttonAudioUnmute:"Unmute music"}},e),this.callbacks=s.extend({onButtonFullscreenClicked:function(){},onButtonAudioClicked:function(){}},i),this.numberVisibleButtons=0,this.titleBar=document.createElement("div"),this.titleBar.classList.add("h5p-jigsaw-puzzle-title-bar"),this.buttonAudio=new o({type:"toggle",classes:["h5p-jigsaw-puzzle-button","h5p-jigsaw-puzzle-button-audio"],disabled:!0,noTabWhenDisabled:!0,hidden:!0,a11y:{active:this.params.a11y.buttonAudioMute,inactive:this.params.a11y.buttonAudioUnmute,disabled:this.params.a11y.disabled}},{onClick:function(e){t.callbacks.onButtonAudioClicked(e)}}),this.titleBar.appendChild(this.buttonAudio.getDOM()),this.buttonFullscreen=new o({type:"toggle",classes:["h5p-jigsaw-puzzle-button","h5p-jigsaw-puzzle-button-fullscreen"],disabled:!0,noTabWhenDisabled:!0,hidden:!0,a11y:{active:this.params.a11y.buttonFullscreenExit,inactive:this.params.a11y.buttonFullscreenEnter,disabled:this.params.a11y.disabled}},{onClick:function(){t.callbacks.onButtonFullscreenClicked()}}),this.titleBar.appendChild(this.buttonFullscreen.getDOM())}var e=t.prototype;return e.getDOM=function(){return this.titleBar},e.showFullscreenButton=function(){this.buttonFullscreen.show(),this.numberVisibleButtons++,this.visible||this.show()},e.showAudioButton=function(){this.buttonAudio.show(),this.numberVisibleButtons++,this.visible||this.show()},e.disableFullscreenButton=function(){this.buttonFullscreen.disable()},e.disableAudioButton=function(){this.buttonAudio.disable()},e.enableFullscreenButton=function(){this.buttonFullscreen.enable()},e.enableAudioButton=function(){this.buttonAudio.enable()},e.getAudioButtonState=function(){return this.buttonAudio.isActive()},e.toggleFullscreenButton=function(t){"string"==typeof t&&("enter"===t?t=!1:"exit"===t&&(t=!0)),"boolean"==typeof t&&this.buttonFullscreen.toggle(t)},e.toggleAudioButton=function(t){"string"==typeof t&&("mute"===t?t=!1:"unmute"===t&&(t=!0)),"boolean"==typeof t&&this.buttonAudio.toggle(t)},e.hasVisibleButtons=function(){return this.numberVisibleButtons>0},e.show=function(){this.titleBar.classList.remove("display-none"),this.visible=!0},e.hide=function(){this.titleBar.classList.add("display-none"),this.false=!0},t}();function l(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return h(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var u=function(){function t(){var t,e,i=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.params=n,this.callbacks=s.extend({onResize:function(){},onCompleted:function(){},onButtonFullscreenClicked:function(){},onInteracted:function(){}},a),this.audios=[],this.tiles=[],this.tilesCreated=0,this.originalSize=null,this.maxSize={heigth:null,width:null},this.borderWidth=2,this.isAnswerGiven=!1,this.h5pQuestionContent=null,this.h5pQuestionButtons=null,this.content=document.createElement("div"),this.content.classList.add("h5p-jigsaw-puzzle-content"),null===(t=this.params)||void 0===t||null===(e=t.puzzleImageInstance)||void 0===e||!e.source){var o=document.createElement("div");return o.classList.add("h5p-jigsaw-puzzle-message"),o.innerText=this.params.l10n.messageNoImage,void this.content.appendChild(o)}this.addTitlebar(),this.addPuzzleArea(),this.image=document.createElement("img"),this.image.addEventListener("load",(function(){i.handleImageLoaded(i.params.imageFormat)})),this.imageCrossOrigin="function"==typeof H5P.getCrossOrigin?H5P.getCrossOrigin(n.puzzleImageInstance.source):"Anonymous",this.image.src=n.puzzleImageInstance.source,"undefined"==typeof H5PEditor&&this.addAudios()}var e=t.prototype;return e.getDOM=function(){return this.content},e.addTitlebar=function(){var t=this;this.titlebar=new r({a11y:{buttonFullscreenEnter:this.params.a11y.buttonFullscreenEnter,buttonFullscreenExit:this.params.a11y.buttonFullscreenExit,buttonAudioMute:this.params.a11y.buttonAudioMute,buttonAudioUnmute:this.params.a11y.buttonAudioUnmute,disabled:this.params.a11y.disabled}},{onButtonAudioClicked:function(e){t.handleButtonAudioClicked(e)},onButtonFullscreenClicked:function(e){t.handleButtonFullscreenClicked(e)}}),this.content.appendChild(this.titlebar.getDOM())},e.addPuzzleArea=function(){var t=this;this.puzzleArea=document.createElement("div"),this.puzzleArea.classList.add("h5p-jigsaw-puzzle-puzzle-area"),"column"===this.params.sortingSpacePosition&&this.puzzleArea.classList.add("h5p-jigsaw-puzzle-puzzle-direction-column"),this.content.appendChild(this.puzzleArea),this.puzzleDropzone=document.createElement("div"),this.puzzleDropzone.classList.add("h5p-jigsaw-puzzle-tile-container"),this.puzzleArea.appendChild(this.puzzleDropzone),window.requestAnimationFrame((function(){var e=window.getComputedStyle(t.puzzleDropzone);t.borderWidth=parseFloat(e.getPropertyValue("border-width"))||t.borderWidth})),this.sortingArea=document.createElement("div"),this.sortingArea.classList.add("h5p-jigsaw-puzzle-sorting-area"),"row"===this.params.sortingSpacePosition&&(this.sortingArea.style.width="".concat(100*this.params.sortingSpace/(100-this.params.sortingSpace),"%")),this.puzzleArea.appendChild(this.sortingArea)},e.createPuzzleTile=function(t){var e=this,i=this.image.naturalWidth/this.params.size.width,n=this.image.naturalHeight/this.params.size.height,s=Math.min(i,n)/2,o=i+(t.x>0?s/2:0),r=n+(t.y>0?s/2:0),l={top:{orientation:0===t.y?"straight":"up",opacity:1},right:{orientation:t.x+1===this.params.size.width?"straight":"left",opacity:1},bottom:{orientation:t.y+1===this.params.size.height?"straight":"up",opacity:1},left:{orientation:0===t.x?"straight":"left",opacity:1}},h="inner";0===t.y?h="top":t.y+1===this.params.size.height&&(h="bottom");var u="inner";0===t.x?u="left":t.x+1===this.params.size.width&&(u="right");var d="".concat(h,"-").concat(u);return new a({id:t.y*this.params.size.width+t.x,baseWidth:i,baseHeight:n,width:o,height:r,gridPosition:{x:t.x,y:t.y},knobSize:s,imageSource:this.image.src,imageCrossOrigin:this.imageCrossOrigin,type:d,stroke:this.params.stroke,borderColor:this.params.tileBorderColor,borders:l,uuid:this.params.uuid,container:this.puzzleArea,size:this.params.size},{onPuzzleTileCreated:function(t){e.handlePuzzleTileCreated(t)},onPuzzleTileMoveStarted:function(t){e.handlePuzzleTileMoveStarted(t)},onPuzzleTileMoved:function(t){e.handlePuzzleTileMoved(t)},onPuzzleTileMoveEnded:function(t){e.handlePuzzleTileMoveEnded(t)}})},e.setTilePosition=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.tile&&("number"!=typeof e.x||e.x<0||"number"!=typeof e.y||e.y<0||(e.animate=null!==(t=e.animate)&&void 0!==t&&t,e.animate&&e.tile.animateMove({duration:e.duration}),this.tiles[e.tile.getId()].position={x:(e.x-this.puzzleDropzone.offsetLeft)/this.puzzleDropzone.offsetWidth,y:(e.y-this.puzzleDropzone.offsetTop)/this.puzzleDropzone.offsetHeight},e.tile.setPosition({x:e.x,y:e.y})))},e.getAssetPath=function(t){var e,i;if(-1!==t.indexOf("sites/default/files/h5p/development"))return t;var n=null,s=null===(e=H5PIntegration)||void 0===e||null===(i=e.contents["cid-".concat(this.params.contentId)])||void 0===i?void 0:i.library;if(-1!==(null==s?void 0:s.indexOf("H5P.JigsawPuzzle "))&&(n=s.replace(" ","-")),!n){var a,o,r=null===(a=H5PIntegration)||void 0===a||null===(o=a.contents["cid-".concat(this.params.contentId)])||void 0===o?void 0:o.jsonContent;if(!r)return null;var l=RegExp('"library":"(H5P.JigsawPuzzle [0-9]+.[0-9]+)"'),h=r.match(l);h&&(n=h[1].replace(" ","-"))}if(!n)return null;var u=H5P.getLibraryPath(n),d=t.substr(t.indexOf("/assets"));return"".concat(u,"/dist").concat(d)},e.addAudios=function(){var t=this;this.params.sound&&!this.audiosDefined&&H5P.SoundJS.initializeDefaultPlugins()&&(H5P.SoundJS.alternateExtensions=["mp3"],["puzzleStarted","puzzleTilePickUp","puzzleTileCorrect","puzzleTileIncorrect","puzzleCompleted"].forEach((function(e){t.params.sound[e]&&t.params.sound[e].length>0&&t.params.sound[e][0].path&&(H5P.SoundJS.registerSound(H5P.getPath(t.params.sound[e][0].path,t.params.contentId),e),t.hasAudios=!0)})),this.audiosDefined=!0)},e.startAudio=function(t){this.isAudioEnabled&&H5P.SoundJS.play(t,H5P.SoundJS.INTERRUPT_NONE,0)},e.stopAudios=function(){H5P.SoundJS.stop()},e.setH5PQuestionElements=function(t){this.h5pQuestionContent=t.querySelector(".h5p-question-content"),this.h5pQuestionButtons=t.querySelector(".h5p-question-buttons")},e.enableFullscreenButton=function(){this.titlebar&&(this.titlebar.enableFullscreenButton(),this.titlebar.showFullscreenButton())},e.toggleFullscreen=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.titlebar.toggleFullscreenButton(t),this.setFixedHeight(t)},e.setFixedHeight=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t){var e=window.getComputedStyle(this.h5pQuestionContent),i=parseFloat(e.getPropertyValue("margin-bottom")),n=parseFloat(e.getPropertyValue("margin-left"))+parseFloat(e.getPropertyValue("margin-right")),s=window.getComputedStyle(this.h5pQuestionButtons),a=parseFloat(s.getPropertyValue("margin-bottom"))+parseFloat(s.getPropertyValue("margin-top"));this.maxSize={height:window.innerHeight-2*this.params.stroke-this.puzzleArea.offsetTop-i-a-this.h5pQuestionButtons.offsetHeight,width:(window.innerWidth-2*this.params.stroke-n)*(100-this.params.sortingSpace)/100}}else this.maxSize={heigth:null,width:null};this.handleResized()},e.reset=function(){var t=this;setTimeout((function(){t.tiles.forEach((function(e){t.showTileBorders(e.instance),e.instance.enable(),e.instance.setDone(!1)})),t.randomizeTiles({useFullArea:t.params.useFullArea,layout:t.params.randomizerPattern,keepDone:!1}),t.isAnswerGiven=!1,t.tilesCreated=0,t.startAudio("puzzleStarted")}),0)},e.randomizeTiles=function(){for(var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=s.shuffleArray(this.tiles),n=i.length;n>=0;n--)this.puzzleArea.appendChild(i[Math.random()*n|0].instance.getDOM());e.keepDone&&(i=i.map((function(t){return t.instance.isDone?null:t})));var a=this.tiles.reduce((function(t,e){return{width:Math.max(t.width,e.instance.getSize().width),height:Math.max(t.height,e.instance.getSize().height)}}),{width:0,height:0}),o=e.useFullArea||this.sortingArea.offsetWidth<a.width||this.sortingArea.offsetHeight<a.height,r={left:this.puzzleArea.offsetLeft,top:this.puzzleArea.offsetTop};o||(r.left+="column"===this.params.sortingSpacePosition?0:this.puzzleDropzone.offsetWidth,r.top+="column"===this.params.sortingSpacePosition?this.puzzleDropzone.offsetHeight:0);var l={x:this.sortingArea.offsetWidth-a.width,y:this.sortingArea.offsetHeight-a.height};o&&(l.x+="column"===this.params.sortingSpacePosition?0:this.puzzleDropzone.offsetWidth,l.y+="column"===this.params.sortingSpacePosition?this.puzzleDropzone.offsetHeight:0),i.forEach((function(e){if(null!==e){var i,n,s=e.instance;i=r.left+Math.random()*l.x,n=r.top+Math.random()*l.y,t.setTilePosition({tile:s,x:i,y:n,animate:!0})}}))},e.moveTileToTarget=function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.animate=null!==(e=i.animate)&&void 0!==e&&e;var n=t.getSize(),s=t.getGridPosition(),a={x:this.puzzleDropzone.offsetLeft+s.x*n.width-Math.sign(s.x)*n.knob/2-s.x*n.knob/2,y:this.puzzleDropzone.offsetTop+s.y*n.height-Math.sign(s.y)*n.knob/2-s.y*n.knob/2};this.setTilePosition({tile:t,x:a.x,y:a.y,animate:i.animate})},e.moveTilesToTarget=function(t){var e,i,n=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=t?t.map((function(t){return t.instance?t:{instance:t}})):this.tiles,s.animate=null===(e=s.animate)||void 0===e||e,s.finalize=null===(i=s.finalize)||void 0===i||i,t.forEach((function(t){n.moveTileToTarget(t.instance,{animate:s.animate}),s.finalize&&n.finalizeTile(t.instance)}))},e.finalizeTile=function(t){t.disable(),t.putInBackground(),this.hideTileBorders(t),t.setDone(!0)},e.updatePuzzleOutlines=function(t,e){var i=e.getDOM(),n=this.puzzleOutlines[t];n.style.width=i.style.width,n.style.height=i.style.height;var s=e.getSize(),a=e.getGridPosition(),o={x:this.puzzleDropzone.offsetLeft+a.x*s.width-Math.sign(a.x)*s.knob/2-a.x*s.knob/2,y:this.puzzleDropzone.offsetTop+a.y*s.height-Math.sign(a.y)*s.knob/2-a.y*s.knob/2};if(this.puzzleOutlines[t].style.left="".concat(o.x,"px"),this.puzzleOutlines[t].style.top="".concat(o.y,"px"),!n.isConnected){if(this.puzzleDropzone.appendChild(n),e.getId()<this.params.size.width){var r=n.querySelector(".border-top");r&&r.setAttribute("stroke-opacity","0")}if(e.getId()%this.params.size.width==this.params.size.width-1){var l=n.querySelector(".border-right");l&&l.setAttribute("stroke-opacity","0")}if(this.params.size.width*(this.params.size.height-1)-1<e.getId()){var h=n.querySelector(".border-bottom");h&&h.setAttribute("stroke-opacity","0")}if(e.getId()%this.params.size.width==0){var u=n.querySelector(".border-left");u&&u.setAttribute("stroke-opacity","0")}}},e.showTileBorders=function(t){t.setBorders({top:!0,right:!0,bottom:!0,left:!0})},e.hideTileBorders=function(t){if(t.getId()<this.params.size.width)t.setBorders({top:!1});else{var e=this.tiles[t.getId()-this.params.size.width].instance;e.isDisabled&&(t.setBorders({top:!1}),e.setBorders({bottom:!1}))}if(t.getId()%this.params.size.width==this.params.size.width-1)t.setBorders({right:!1});else{var i=this.tiles[t.getId()+1].instance;i.isDisabled&&(t.setBorders({right:!1}),i.setBorders({left:!1}))}if(this.params.size.width*(this.params.size.height-1)-1<t.getId())t.setBorders({bottom:!1});else{var n=this.tiles[t.getId()+this.params.size.width].instance;n.isDisabled&&(t.setBorders({bottom:!1}),n.setBorders({top:!1}))}if(t.getId()%this.params.size.width==0)t.setBorders({left:!1});else{var s=this.tiles[t.getId()-1].instance;s.isDisabled&&(t.setBorders({left:!1}),s.setBorders({right:!1}))}},e.getAnswerGiven=function(){return this.isAnswerGiven},e.getScore=function(){return this.tiles.reduce((function(t,e){return t+(e.instance.isDone?1:0)}),0)},e.getCurrentState=function(){return{audioButtonState:this.titlebar.getAudioButtonState(),tiles:this.tiles.map((function(t){return t.instance.isDone}))}},e.handleImageLoaded=function(t){this.originalSize={width:this.image.naturalWidth,height:this.image.naturalHeight};for(var e=0;e<this.params.size.height;e++)for(var i=0;i<this.params.size.width;i++)this.tiles.push({instance:this.createPuzzleTile({x:i,y:e,format:t}),position:{x:0,y:0}});if(this.params.showBackground){var n=document.createElement("img");n.classList.add("h5p-jigsaw-puzzle-background-image"),n.setAttribute("src",this.image.src),this.puzzleDropzone.appendChild(n)}var s,a;this.hasAudios&&(this.titlebar.showAudioButton(),this.titlebar.enableAudioButton(),this.isAudioEnabled=(null===(s=this.params)||void 0===s||null===(a=s.previousState)||void 0===a?void 0:a.audioButtonState)||!0,this.titlebar.toggleAudioButton(this.isAudioEnabled));this.handleResized()},e.handleResized=function(){var t=this;if(this.originalSize){var e=(this.puzzleDropzone.offsetWidth-this.borderWidth)/this.originalSize.width,i={height:e*this.originalSize.height-this.borderWidth,width:e*this.originalSize.width-this.borderWidth};if(this.maxSize.height&&(this.puzzleDropzone.style.width||i.height>this.maxSize.height||i.width>this.maxSize.width)?((this.maxSize.height-this.borderWidth)/this.originalSize.height<(this.maxSize.width-this.borderWidth)/this.originalSize.width?(this.scale=(this.maxSize.height-this.borderWidth)/this.originalSize.height,this.puzzleDropzone.style.height="".concat(this.maxSize.height-2*this.borderWidth,"px"),this.puzzleDropzone.style.width="".concat(this.scale*this.originalSize.width-this.borderWidth,"px")):(this.scale=(this.maxSize.width-this.borderWidth)/this.originalSize.width,this.puzzleDropzone.style.height="".concat(this.scale*this.originalSize.height-this.borderWidth,"px"),this.puzzleDropzone.style.width="".concat(this.maxSize.width-2*this.borderWidth,"px")),this.puzzleDropzone.style.flexShrink=0):(this.scale=e,this.puzzleDropzone.style.height="".concat(i.height,"px"),this.puzzleDropzone.style.width="",this.puzzleDropzone.style.flexShrink=""),"column"===this.params.sortingSpacePosition){var n=this.params.sortingSpaceColumn/100*parseFloat(this.puzzleDropzone.style.height);this.sortingArea.style.height="".concat(n,"px")}this.tiles.forEach((function(e,i){e.instance.setScale(t.scale),e.instance.setPosition({x:e.position.x*t.puzzleDropzone.offsetWidth+t.puzzleDropzone.offsetLeft,y:e.position.y*t.puzzleDropzone.offsetHeight+t.puzzleDropzone.offsetTop}),t.puzzleOutlines&&t.updatePuzzleOutlines(i,e.instance)}))}this.callbacks.onResize()},e.handlePuzzleTileMoveStarted=function(t){this.tiles.forEach((function(t){t.instance.putInBackground(),t.instance.isDisabled||t.instance.ghost()})),t.putOnTop(),t.unghost(),this.startAudio("puzzleTilePickUp")},e.handlePuzzleTileMoved=function(){},e.handlePuzzleTileMoveEnded=function(e){this.tiles.forEach((function(t){t.instance.unghost()}));var i=e.getPosition(),n=e.getSize(),s=e.getGridPosition();this.tiles[e.getId()].position=i;var a={x:this.puzzleDropzone.offsetLeft+s.x*n.width-Math.sign(s.x)*n.knob/2-s.x*n.knob/2,y:this.puzzleDropzone.offsetTop+s.y*n.height-Math.sign(s.y)*n.knob/2-s.y*n.knob/2},o=Math.min(n.width,n.height)*t.SLACK_FACTOR;Math.abs(i.x-a.x)<o&&Math.abs(i.y-a.y)<o?(this.setTilePosition({tile:e,x:a.x,y:a.y}),this.finalizeTile(e),this.startAudio("puzzleTileCorrect")):(this.setTilePosition({tile:e,x:i.x,y:i.y}),e.setDone(!1),this.startAudio("puzzleTileIncorrect")),this.isAnswerGiven=!0,this.callbacks.onInteracted(),this.tiles.every((function(t){return t.instance.isDone}))&&this.handlePuzzleCompleted({xAPI:!0})},e.handleButtonAudioClicked=function(t){var e=(null==t?void 0:t.currentTarget.classList)||[];this.isAudioEnabled=-1!==l(e).indexOf("h5p-jigsaw-puzzle-button-active"),this.isAudioEnabled||this.stopAudios()},e.handleButtonFullscreenClicked=function(){this.callbacks.onButtonFullscreenClicked()},e.handlePuzzleCompleted=function(t){this.startAudio("puzzleCompleted"),this.callbacks.onCompleted(t)},e.handlePuzzleTileCreated=function(t){var e=this;if(this.params.previousState.tiles&&!0===this.params.previousState.tiles[t.getId()]&&this.moveTilesToTarget([t],{animate:!1,finalize:!0}),this.puzzleArea.appendChild(t.getDOM()),this.tilesCreated++,this.tilesCreated===this.params.size.width*this.params.size.height){if(this.params.showPuzzleOutlines){var i=window.getComputedStyle(this.puzzleDropzone).getPropertyValue("border-color").replace(/[^.^\d,]/g,"").split(",").map((function(t){return parseFloat(t,10)}));4===i.length?i[3]/=2:i=[0,0,0,.05],i="rgba(".concat(i.join(","),")"),setTimeout((function(){e.puzzleOutlines=e.tiles.map((function(t){var e=t.instance.getDOM().cloneNode(!0);e.setAttribute("disabled","disabled");var n=e.querySelector("svg path");return n&&n.parentNode.removeChild(n),e.querySelectorAll("svg path").forEach((function(t){t.setAttribute("stroke",i)})),e}))}),0)}setTimeout((function(){e.handleResized(),e.handleAllTilesCreated()}),0)}},e.handleAllTilesCreated=function(){var t,e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if((null===(t=this.puzzleArea)||void 0===t?void 0:t.offsetWidth)>0)this.handleDOMVisible();else{if(0===n)return void this.tiles.forEach((function(t){t.instance.show()}));this.tiles.forEach((function(t){t.instance.hide()})),clearTimeout(this.timeoutWaitForPuzzleArea),this.timeoutWaitForPuzzleArea=setTimeout((function(){e.handleAllTilesCreated(i,n-1)}),i)}},e.handleDOMVisible=function(){var t=this;this.tiles.forEach((function(t){t.instance.show()})),this.moveTilesToTarget(this.tiles,{animate:!1,finalize:!1}),setTimeout((function(){t.randomizeTiles({useFullArea:t.params.useFullArea,keepDone:Object.keys(t.params.previousState).length>0}),t.startAudio("puzzleStarted"),window.requestAnimationFrame((function(){t.isPuzzleSetUp=!0,setTimeout((function(){t.handleResized()}),250)}))}),500)},e.updateTitlebarVisibility=function(){this.titlebar.hasVisibleButtons()||this.titlebar.hide()},t}();function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}u.SLACK_FACTOR=.25;var c=function(t){var e,i;function n(e,i){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};for(var o in(n=t.call(this,"jigsaw-puzzle")||this).params=s.extend({tilesHorizontal:4,tilesVertical:3,behaviour:{sortingSpacePosition:"row",sortingSpace:50,sortingSpaceColumn:100,useFullArea:!1,enableComplete:!0,enableSolutionsButton:!0,enableRetry:!0,showBackground:!0,showPuzzleOutlines:!0},l10n:{complete:"Complete",tryAgain:"Retry",messageNoImage:"There was no image given for this jigsaw puzzle."},a11y:{buttonFullscreenEnter:"Enter fullscreen mode",buttonFullscreenExit:"Exit fullscreen mode",complete:"Complete the puzzle. All tiles will be put to their correct position.",tryAgain:"Retry the puzzle. All puzzle tiles will be shuffled on the canvas.",disabled:"Disabled",close:"Close"}},e),n.params.l10n)n.params.l10n[o]=s.stripHTML(s.htmlDecode(n.params.l10n[o]));for(var r in n.params.a11y)n.params.a11y[r]=s.stripHTML(s.htmlDecode(n.params.a11y[r]));return n.contentId=i,n.extras=a,n.previousState=n.extras.previousState||{},n.uuid=H5P.createUUID(),n.params.puzzleImage&&(n.puzzleImageInstance=H5P.newRunnable(n.params.puzzleImage,n.contentId)),n.on("resize",(function(){n.handleH5PResized()})),n}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,d(e,i);var a=n.prototype;return a.registerDomElements=function(){var t,e,i,n,s,a,o,r,l=this;this.content=new u({contentId:this.contentId,imageFormat:null===(t=this.params)||void 0===t||null===(e=t.puzzleImage)||void 0===e||null===(i=e.params)||void 0===i||null===(n=i.file)||void 0===n?void 0:n.mime,previousState:this.previousState,puzzleImageInstance:this.puzzleImageInstance,showBackground:this.params.behaviour.showBackground,showPuzzleOutlines:this.params.behaviour.showPuzzleOutlines,size:{width:this.params.tilesHorizontal,height:this.params.tilesVertical},sortingSpacePosition:this.params.behaviour.sortingSpacePosition,sortingSpace:this.params.behaviour.sortingSpace,sortingSpaceColumn:this.params.behaviour.sortingSpaceColumn,sound:this.params.sound||{},stroke:Math.max(window.innerWidth/750,1.75),tileBorderColor:"rgba(88, 88, 88, 0.5)",useFullArea:this.params.behaviour.useFullArea,uuid:this.uuid,a11y:{buttonFullscreenEnter:this.params.a11y.buttonFullscreenEnter,buttonFullscreenExit:this.params.a11y.buttonFullscreenExit,disabled:this.params.a11y.disabled,close:this.params.a11y.close},l10n:{messageNoImage:this.params.l10n.messageNoImage}},{onResize:function(){l.handleOnResize()},onCompleted:function(t){l.handlePuzzleCompleted(t)},onButtonFullscreenClicked:function(){l.toggleFullscreen()},onInteracted:function(){l.handleInteracted()}}),this.setContent(this.content.getDOM()),null!==(s=this.params)&&void 0!==s&&null!==(a=s.puzzleImage)&&void 0!==a&&null!==(o=a.params)&&void 0!==o&&null!==(r=o.file)&&void 0!==r&&r.path&&(this.addButtons(),"complete"===document.readyState?window.requestAnimationFrame((function(){l.handleDOMInitialized()})):document.addEventListener("readystatechange",(function(){"complete"===document.readyState&&window.requestAnimationFrame((function(){l.handleDOMInitialized()}))})),window.addEventListener("orientationchange",(function(){H5P.isFullscreen&&setTimeout((function(){l.content.setFixedHeight(!0)}),200)}),!1))},a.addButtons=function(){var t,e,i,n,s,a=this;this.addButton("complete",this.params.l10n.complete,(function(){a.handleClickButtonComplete({xAPI:!0})}),this.params.behaviour.enableComplete&&(null===(t=this.previousState)||void 0===t||null===(e=t.tiles)||void 0===e?void 0:e.some((function(t){return!t}))),{"aria-label":this.params.a11y.complete},{}),this.addButton("try-again",this.params.l10n.tryAgain,(function(){a.handleClickButtonRetry()}),this.params.behaviour.enableRetry&&!(null===(i=this.previousState)||void 0===i||!i.tiles)&&(null===(n=this.previousState)||void 0===n||null===(s=n.tiles)||void 0===s?void 0:s.some((function(t){return t}))),{"aria-label":this.params.a11y.tryAgain},{})},a.disableButtons=function(){for(var t in this.buttons)this.disableButton(t)},a.disableButton=function(t){this.buttons[t]&&(this.buttons[t].setAttribute("disabled",!0),this.buttons[t].classList.add("disabled"))},a.enableButtons=function(){for(var t in this.buttons)this.enableButton(t)},a.enableButton=function(t){this.buttons[t]&&(this.buttons[t].removeAttribute("disabled"),this.buttons[t].classList.remove("disabled"))},a.toggleFullscreen=function(t){var e=this;this.container&&("string"==typeof t&&("enter"===t?t=!1:"exit"===t&&(t=!0)),"boolean"!=typeof t&&(t=!H5P.isFullscreen),!0===t?H5P.fullScreen(H5P.jQuery(this.container),this):(H5P.exitFullScreen(),setTimeout((function(){e.trigger("resize")}),100),setTimeout((function(){e.trigger("resize")}),500)))},a.getAnswerGiven=function(){return!!this.content&&this.content.getAnswerGiven()},a.getScore=function(){return this.content?this.content.getScore():0},a.getMaxScore=function(){return this.params.tilesHorizontal*this.params.tilesVertical},a.showSolutions=function(){this.content||(this.handleClickButtonComplete({xAPI:!1}),this.trigger("resize"))},a.resetTask=function(){this.params.behaviour.enableComplete&&this.showButton("complete"),this.hideButton("try-again"),this.content&&this.content.reset(),this.trigger("resize")},a.getXAPIData=function(){return{statement:this.getXAPIAnsweredEvent().data.statement}},a.getXAPIAnsweredEvent=function(){var t=this.createXAPIEvent("answered");return t.setScoredResult(this.getScore(),this.getMaxScore(),this,!0,this.isPassed()),t},a.createXAPIEvent=function(t){var e=this.createXAPIEventTemplate(t);return s.extend(e.getVerifiedStatementValue(["object","definition"]),this.getxAPIDefinition()),e},a.getxAPIDefinition=function(){var t=this.getDescription();return{name:{"en-US":this.getTitle()},description:{"en-US":t},type:"http://adlnet.gov/expapi/activities/cmi.interaction",interactionType:"other"}},a.isPassed=function(){return this.getScore()>=this.getMaxScore()},a.getTitle=function(){var t;return this.extras.metadata&&(t=this.extras.metadata.title),t=t||n.DEFAULT_DESCRIPTION,H5P.createTitle(t)},a.getDescription=function(){return this.params.taskDescription||n.DEFAULT_DESCRIPTION},a.getCurrentState=function(){var t,e,i,n;if(null!==(t=this.params)&&void 0!==t&&null!==(e=t.puzzleImage)&&void 0!==e&&null!==(i=e.params)&&void 0!==i&&null!==(n=i.file)&&void 0!==n&&n.path&&this.content)return this.content.getCurrentState()},a.handleDOMInitialized=function(){var t=this;this.container=s.closestParent(this.content.getDOM(),".h5p-jigsaw-puzzle"),this.container&&(this.content.setH5PQuestionElements(this.container),this.isRoot()&&H5P.fullscreenSupported?(this.content.enableFullscreenButton(),this.on("enterFullScreen",(function(){setTimeout((function(){t.content.toggleFullscreen(!0)}),200)})),this.on("exitFullScreen",(function(){t.content.toggleFullscreen(!1)}))):this.content.updateTitlebarVisibility(),this.buttons={},this.buttons.complete=this.container.querySelector(".h5p-question-complete"),this.buttons["try-again"]=this.container.querySelector(".h5p-question-try-again"))},a.handleH5PResized=function(){!this.bubblingUpwards&&this.content&&this.content.handleResized()},a.handleOnResize=function(){this.bubblingUpwards=!0,this.trigger("resize"),this.bubblingUpwards=!1},a.handleInteracted=function(){this.getScore()>0&&this.showButton("try-again"),this.triggerXAPI("interacted")},a.handlePuzzleCompleted=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.hideButton("complete"),this.showButton("try-again"),t.xAPI&&this.trigger(this.getXAPIAnsweredEvent())},a.handleClickButtonComplete=function(t){this.handleInteracted(),this.content.handlePuzzleCompleted(t),this.content.moveTilesToTarget()},a.handleClickButtonRetry=function(){this.resetTask()},n}(H5P.Question);c.DEFAULT_DESCRIPTION="Jigsaw Puzzle",H5P=H5P||{},H5P.JigsawPuzzle=c}();